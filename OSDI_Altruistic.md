# Altruistic Scheduling in Multi-Resource Clusters

本篇文章通过一种利他和延迟调度策略，对任务进行调度。调度面向的是长期任务调度，能够满度多维度的度量需求，如公平性、资源利用率、任务平均完成时间。

文章通过一个具体的例子进行讲解。
**场景**：
 如图所示，当前存在两个任务，Job1和Job2，Job1内部存在三个子任务S0，S1，S2，Job2只有S0。对于每个任务，该任务所需要的资源在下方显示。如S0，执行该任务需要0.29个单位的资源，需要用时1个单位。
  **目标** ：
 对这两个任务进行调度，使得资源利用率高，平均任务完成时间短。
 
## 发现问题
 在文章中，作者发现，在现有的调度系统中，主要存在如下的一些特点:
 * 现有的调度系统关注瞬时公平性(instantaneous fairness)以及短期优化(short-term
optimizations)
 * 现在的长任务给了调度更多的灵活性
 * 数据并行类的作业对于长作业优化提供了更多机会

 
### 一. 现有的调度系统关注瞬时公平性以及短期优化
 在任务的调度过程中，主要有两个维度的调度。第一是任务间的调度，即job1和job2 之间的调度。第二类是任务内的调度，比如job1中存在S0，S1，S2这三个任务，调度的目标就是这三个子任务。
    
    那什么是保证瞬时公平性和短期优化的调度方法呢？
    首先假设我们知道所有的任务，它的运行时间，以及其对于资源需求多少。那对于公平性的保证，首先对资源进行平分，假如资源总量为1，现在有两个任务，那一个任务就分配0.5.这样就保证了公平性。这样的调度是**任务间的调度**。
    在分配了资源以后，任务拿到了分配的资源，就需要充分利用自己手里的资源，也就是需要进行任务内部的调度。这样就是**任务内的调度**。内部调度可以采用贪心策略，使得任务安排的紧紧的。这样就可以使得资源利用率提高。经过这种调度方案的调度后效果如图所示：
    
    
从当前的调度策略看，既保证了公平性，保证资源隔离，同时也照顾到了资源利用率。那么问题来了。这样的调度就很好吗？那我们能继续优化吗？当然可以，这也就是这篇论文的贡献点。

从上述的瞬时公平性和短期优化的调度方法还是存在问题的。从图中可以看到，这种调度方法并不是最好的，每个资源内部还存在很多空闲没有使用的资源。这里作者提出了一个很重要的一个观念
> **用户并不关心瞬时的调度效果，关心的是整个作业的完成时间**。

那也就说，只要保证任务的总体完成时间不增长，那么我就可以在任务原来完成时间之前随意调度子任务，使得资源利用率提供，或者减少JCT（Job Completion time）。这样也就多出了很多操作的可能性(前面提到的第二个特点)。

综上所述。基于用户只关心JCT（JCT短，资源利用率也不会差），那咱们就在基本JCT之前调度任务，尽量提高资源利用率以及任务平均的完成时间。

## 提出问题

通过现有的调度策略，会有一个任务的完成时间。如何在保证任务完成时间不会增长的情况下，提出一个新得调度方案，使得减少平均任务完成时间，提高资源利用率，同时也能兼顾公平性等特性？
 
 
## 解决问题